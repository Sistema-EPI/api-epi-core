{
  "financial_reports_api_contract": {
    "base_url": "http://localhost:8081/v1/financial-reports",
    "authentication": {
      "headers": {
        "Authorization": "Bearer {jwt_token}",
        "x-api-token": "{company_api_key}"
      }
    },
    "routes": {
      "1_annual_costs": {
        "endpoint": "GET /{companyId}/annual-costs",
        "description": "Retorna custos anuais por EPI com opção de filtrar por ano",
        "parameters": {
          "path": {
            "companyId": {
              "type": "string",
              "format": "uuid",
              "description": "ID da empresa",
              "example": "3d00886d-a177-4236-a594-8f0d17717325"
            }
          },
          "query": {
            "year": {
              "type": "number",
              "optional": true,
              "description": "Ano específico para filtrar (opcional)",
              "example": 2025
            }
          }
        },
        "response_example": {
          "message": "Custos anuais por EPI recuperados com sucesso",
          "data": [
            {
              "epiId": "248ed680-2e98-4ebd-8b6c-bc7bced63307",
              "nomeEpi": "Capacete de Segurança",
              "ca": "15081",
              "ano": 2025,
              "totalGasto": 91.8,
              "quantidadeEntregue": 2
            },
            {
              "epiId": "4e33a684-7baf-4e05-a22c-e8a84843a6a0",
              "nomeEpi": "Calçado de Segurança",
              "ca": "20594",
              "ano": 2025,
              "totalGasto": 89.9,
              "quantidadeEntregue": 1
            },
            {
              "epiId": "c512b55c-4d13-4adb-8f13-f758807d3d1d",
              "nomeEpi": "Luvas de Proteção",
              "ca": "39240",
              "ano": 2025,
              "totalGasto": 76.5,
              "quantidadeEntregue": 3
            }
          ]
        },
        "frontend_usage": {
          "chart_types": [
            "Bar Chart - Gastos por EPI",
            "Line Chart - Evolução temporal de gastos",
            "Pie Chart - Distribuição percentual de gastos"
          ],
          "suggested_libraries": ["Chart.js", "Recharts", "D3.js"],
          "data_processing": {
            "group_by_year": "Agrupar dados por ano para análise temporal",
            "group_by_epi": "Agrupar por EPI para comparações",
            "sort_by_cost": "Ordenar por totalGasto para rankings"
          }
        }
      },
      "2_annual_summary": {
        "endpoint": "GET /{companyId}/annual-summary",
        "description": "Resumo financeiro agrupado por ano e EPI",
        "parameters": {
          "path": {
            "companyId": {
              "type": "string",
              "format": "uuid",
              "description": "ID da empresa"
            }
          }
        },
        "response_example": {
          "message": "Resumo financeiro anual recuperado com sucesso",
          "data": {
            "2024": {
              "248ed680-2e98-4ebd-8b6c-bc7bced63307": {
                "nomeEpi": "Capacete de Segurança",
                "ca": "15081",
                "totalGasto": 45.9,
                "quantidadeEntregue": 1
              },
              "c512b55c-4d13-4adb-8f13-f758807d3d1d": {
                "nomeEpi": "Luvas de Proteção",
                "ca": "39240",
                "totalGasto": 25.5,
                "quantidadeEntregue": 1
              }
            },
            "2025": {
              "248ed680-2e98-4ebd-8b6c-bc7bced63307": {
                "nomeEpi": "Capacete de Segurança",
                "ca": "15081",
                "totalGasto": 91.8,
                "quantidadeEntregue": 2
              },
              "4e33a684-7baf-4e05-a22c-e8a84843a6a0": {
                "nomeEpi": "Calçado de Segurança",
                "ca": "20594",
                "totalGasto": 89.9,
                "quantidadeEntregue": 1
              }
            }
          }
        },
        "frontend_usage": {
          "chart_types": [
            "Multi-Line Chart - Comparação anual por EPI",
            "Stacked Bar Chart - Gastos empilhados por ano",
            "Heatmap - Matriz ano vs EPI",
            "Dashboard Cards - Resumos por ano"
          ],
          "data_processing": {
            "flatten_structure": "Transformar objeto aninhado em array para gráficos",
            "calculate_totals": "Somar gastos totais por ano",
            "year_comparison": "Comparar crescimento/redução entre anos"
          }
        }
      },
      "3_monthly_data": {
        "endpoint": "GET /{companyId}/monthly-data",
        "description": "Dados financeiros mensais para um ano específico",
        "parameters": {
          "path": {
            "companyId": {
              "type": "string",
              "format": "uuid",
              "description": "ID da empresa"
            }
          },
          "query": {
            "year": {
              "type": "number",
              "required": true,
              "description": "Ano para buscar dados mensais",
              "example": 2025
            }
          }
        },
        "response_example": {
          "message": "Dados financeiros mensais de 2025 recuperados com sucesso",
          "data": {
            "janeiro": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "fevereiro": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "março": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "abril": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "maio": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "junho": {
              "totalGasto": 277.1,
              "quantidadeEntregue": 7,
              "episEntregues": 4
            },
            "julho": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "agosto": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "setembro": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "outubro": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "novembro": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            },
            "dezembro": {
              "totalGasto": 0,
              "quantidadeEntregue": 0,
              "episEntregues": 0
            }
          }
        },
        "frontend_usage": {
          "chart_types": [
            "Line Chart - Evolução mensal de gastos",
            "Bar Chart - Comparação mensal",
            "Area Chart - Tendência de gastos ao longo do ano",
            "Multi-Axis Chart - Gastos vs Quantidade vs EPIs únicos"
          ],
          "data_processing": {
            "convert_to_array": "Transformar objeto em array [{mes, totalGasto, quantidadeEntregue, episEntregues}]",
            "calculate_averages": "Calcular médias mensais",
            "identify_peaks": "Identificar meses com maiores gastos",
            "monthly_growth": "Calcular crescimento mês a mês"
          }
        }
      },
      "4_top_expensive": {
        "endpoint": "GET /{companyId}/top-expensive",
        "description": "Top N EPIs mais caros em um ano específico",
        "parameters": {
          "path": {
            "companyId": {
              "type": "string",
              "format": "uuid",
              "description": "ID da empresa"
            }
          },
          "query": {
            "year": {
              "type": "number",
              "required": true,
              "description": "Ano para buscar os EPIs mais caros",
              "example": 2025
            },
            "limit": {
              "type": "number",
              "optional": true,
              "default": 5,
              "description": "Número de EPIs a retornar",
              "example": 3
            }
          }
        },
        "response_example": {
          "message": "Top 3 EPIs mais caros de 2025 recuperados com sucesso",
          "data": [
            {
              "epiId": "248ed680-2e98-4ebd-8b6c-bc7bced63307",
              "nomeEpi": "Capacete de Segurança",
              "ca": "15081",
              "ano": 2025,
              "totalGasto": 91.8,
              "quantidadeEntregue": 2
            },
            {
              "epiId": "4e33a684-7baf-4e05-a22c-e8a84843a6a0",
              "nomeEpi": "Calçado de Segurança",
              "ca": "20594",
              "ano": 2025,
              "totalGasto": 89.9,
              "quantidadeEntregue": 1
            },
            {
              "epiId": "c512b55c-4d13-4adb-8f13-f758807d3d1d",
              "nomeEpi": "Luvas de Proteção",
              "ca": "39240",
              "ano": 2025,
              "totalGasto": 76.5,
              "quantidadeEntregue": 3
            }
          ]
        },
        "frontend_usage": {
          "chart_types": [
            "Horizontal Bar Chart - Ranking de EPIs mais caros",
            "Pie Chart - Distribuição dos top EPIs",
            "Donut Chart - Percentual de gastos dos top EPIs",
            "Treemap - Visualização hierárquica de gastos"
          ],
          "data_processing": {
            "calculate_percentages": "Calcular percentual de cada EPI no total",
            "create_ranking": "Criar ranking numerado (1º, 2º, 3º...)",
            "color_coding": "Aplicar cores diferentes para cada posição",
            "cost_per_unit": "Calcular custo médio por unidade (totalGasto/quantidadeEntregue)"
          }
        }
      }
    },
    "common_frontend_patterns": {
      "dashboard_cards": {
        "total_annual_cost": "Somar todos os totalGasto do ano",
        "total_items_delivered": "Somar todas as quantidadeEntregue",
        "unique_epis_count": "Contar EPIs únicos entregues",
        "average_cost_per_item": "Calcular custo médio por item entregue",
        "most_expensive_epi": "EPI com maior totalGasto",
        "busiest_month": "Mês com maior quantidadeEntregue"
      },
      "filters_and_controls": {
        "year_selector": "Dropdown para selecionar ano",
        "epi_filter": "Checkbox/multi-select para filtrar EPIs específicos",
        "date_range_picker": "Para análises customizadas",
        "chart_type_toggle": "Alternar entre tipos de gráfico"
      },
      "data_transformation_examples": {
        "monthly_data_to_chart": {
          "input": "Objeto com chaves de meses",
          "output": "Array de objetos [{month: 'janeiro', value: 277.1}, ...]",
          "code_example": "Object.entries(monthlyData).map(([month, data]) => ({month, ...data}))"
        },
        "annual_summary_to_chart": {
          "input": "Objeto aninhado por ano e EPI",
          "output": "Array flat para gráficos",
          "code_example": "Object.entries(summary).flatMap(([year, epis]) => Object.entries(epis).map(([epiId, data]) => ({year, epiId, ...data})))"
        }
      }
    },
    "error_handling": {
      "404_company_not_found": {
        "message": "Empresa não encontrada",
        "action": "Verificar se companyId está correto"
      },
      "401_unauthorized": {
        "message": "Token inválido",
        "action": "Renovar token de autenticação"
      },
      "400_bad_request": {
        "message": "Parâmetros inválidos",
        "action": "Verificar formato dos parâmetros"
      }
    },
    "performance_considerations": {
      "caching": "Considerar cache para dados que não mudam frequentemente",
      "pagination": "Para grandes volumes de dados, implementar paginação",
      "debouncing": "Para filtros em tempo real, usar debounce",
      "lazy_loading": "Carregar gráficos sob demanda"
    }
  }
}
